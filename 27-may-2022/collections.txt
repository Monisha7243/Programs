--DISPLAY ALL COLUMN NAMES IN PASSING TABLE USING COLLECTION

CREATE OR REPLACE PROCEDURE SP_COLL(P_TABLE VARCHAR2) AS
V_STR VARCHAR2(200);
V_STR1 VARCHAR2(200);
V_CNT NUMBER;
TYPE T_TAB IS TABLE OF VARCHAR2(20);
COLUMN_NAMES_LIST T_TAB;
TABLE_NOT EXCEPTION;
BEGIN
V_STR1 := 'SELECT COUNT(*)FROM USER_TABLES WHERE TABLE_NAME='||''''||UPPER(P_TABLE)||'''';
EXECUTE IMMEDIATE V_STR1 INTO V_CNT;
IF V_CNT=0 THEN
     RAISE TABLE_NOT;
ELSE
    V_STR :='SELECT COLUMN_NAME FROM USER_TAB_COLUMNS WHERE TABLE_NAME='||''''||UPPER(P_TABLE)||'''';
    EXECUTE IMMEDIATE V_STR BULK COLLECT INTO COLUMN_NAMES_LIST;
    FOR I IN 1..COLUMN_NAMES_LIST.LAST LOOP
        DBMS_OUTPUT.PUT_LINE(COLUMN_NAMES_LIST(I));
    END LOOP;
END IF;
EXCEPTION
WHEN TABLE_NOT THEN
DBMS_OUTPUT.PUT_LINE('TABLE NAME IS NOT VALID');
END;


EXEC SP_COLL('EMP');

SET SERVEROUTPUT ON;

--DISPLAY CHILD TABLE OR PARENT TABLE

CREATE OR REPLACE PROCEDURE SP_COLLS(P_TABLE VARCHAR2) AS
V_STR VARCHAR2(500);
V_STR1 VARCHAR2(500);
V_CNT NUMBER;
TYPE T_TAB IS TABLE OF VARCHAR2(20);
CONS_NAMES_LIST T_TAB;
TABLE_NOT EXCEPTION;
BEGIN
V_STR1 := 'SELECT COUNT(*)FROM USER_TABLES WHERE TABLE_NAME='||''''||UPPER(P_TABLE)||'''';
EXECUTE IMMEDIATE V_STR1 INTO V_CNT;
IF V_CNT=0 THEN
     RAISE TABLE_NOT;
ELSE
    V_STR :='SELECT TABLE_NAME FROM USER_CONSTRAINTS WHERE CONSTRAINT_NAME IN (SELECT R_CONSTRAINT_NAME FROM 
                                                                USER_CONSTRAINTS WHERE TABLE_NAME='||''''||UPPER(P_TABLE)||''''||')';
    EXECUTE IMMEDIATE V_STR BULK COLLECT INTO CONS_NAMES_LIST;
    FOR I IN 1..CONS_NAMES_LIST.LAST LOOP
        DBMS_OUTPUT.PUT_LINE(CONS_NAMES_LIST(I));
    END LOOP;
END IF;
EXCEPTION
WHEN TABLE_NOT THEN
DBMS_OUTPUT.PUT_LINE('TABLE NAME IS NOT VALID');
END;

EXEC SP_COLLS('EMP');

set serveroutput on;






