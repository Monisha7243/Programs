-- NON-PRE DEFINIED ERROR

CREATE OR REPLACE PROCEDURE SP_NON_EXP AS
CHILD_REC_EXC EXCEPTION;
PRAGMA EXCEPTION_INIT(CHILD_REC_EXC,-2292);
BEGIN
DELETE FROM DEPT WHERE DEPTNO=10;
EXCEPTION 
WHEN CHILD_REC_EXC THEN
--DBMS_OUTPUT.PUT_LINE('CANNT DELETE PARENT RECORD');
--DBMS_OUTPUT.PUT_LINE(SQLCODE||', '||SQLERRM);
RAISE_APPLICATION_ERROR(-20015,'CANNOT DELETE');
END;

DELETE FROM DEPT WHERE DEPTNO=10;

EXEC SP_NON_EXP;

SET SERVEROUTPUT ON


--NON-PRE DEFINED ERROR
CREATE OR REPLACE PROCEDURE SP_TABLE AS
TABLE_NOT EXCEPTION;
PRAGMA EXCEPTION_INIT(TABLE_NOT,-1400);
BEGIN
INSERT INTO CUS VALUES(NULL,'XYZ','RS','F','XYS@GMAIL.COM',789065431,'US','12-DEC-45',20,'A');
EXCEPTION
WHEN TABLE_NOT THEN
RAISE_APPLICATION_ERROR(-20015,'PRIMARY NOT SUPPORT NULL');
END;

EXEC SP_TABLE; 

--USER DEFINED EXCEPTION
CREATE OR REPLACE PROCEDURE SP_AGE AS
VALUE_NOT EXCEPTION;
V_CNT NUMBER;
BEGIN
SELECT PHONE INTO V_CNT FROM CUS WHERE CUST_BKEY=110;
IF LENGTH(V_CNT)=10 THEN
    DBMS_OUTPUT.PUT_LINE('VALID');  
ELSE 
    RAISE VALUE_NOT;
END IF;
EXCEPTION
WHEN VALUE_NOT THEN
DBMS_OUTPUT.PUT_LINE('PHONE NO IS NOT VALID');
END;

SELECT * FROM CUS;

EXEC SP_AGE;

INSERT INTO CUS VALUES(110,'XYZ','RS','F','XYS@GMAIL.COM',789065431,'US','12-DEC-45',20,'A');

INSERT INTO CUS VALUES(NULL,'XYZ','RS','F','XYS@GMAIL.COM',789065431,'US','12-DEC-45',20,'A');
