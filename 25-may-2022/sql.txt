---MOISTURE SQL QUEREY

SELECT SPECIFICATION_MIX,ACTUAL_VALUE,CASE WHEN SPECIFICATION_MIX LIKE 'Ash%' THEN ACTUAL_VALUE
    ELSE 0
        END ASH_VAL,
    CASE WHEN SPECIFICATION_MIX LIKE 'Moisture%' THEN ACTUAL_VALUE
    ELSE 0
        END MOISTURE_VAL,
    CASE WHEN SPECIFICATION_MIX LIKE 'Protein%' THEN ACTUAL_VALUE
    ELSE 0
        END PROTIEN_VAL
FROM INPUT;
     

---AGENCY IN SQL QUERY

SELECT D.AGENCY,D.PROGRAM_NAME,FISCAL_YEAR,ORIGINAL_APPR_AMOUNT,E.PROGRAM_AMT,
    A.AGENCY_AMT,B.TOT_AMT
    FROM (SELECT SUM(ORIGINAL_APPR_AMOUNT)PROGRAM_AMT,PROGRAM_NAME FROM AGENCY_SRC GROUP BY PROGRAM_NAME)E,
          (SELECT SUM(ORIGINAL_APPR_AMOUNT)AGENCY_AMT,AGENCY FROM AGENCY_SRC GROUP BY AGENCY)A,
          (SELECT SUM(ORIGINAL_APPR_AMOUNT)TOT_AMT FROM AGENCY_SRC)B, AGENCY_SRC D
    WHERE E.PROGRAM_NAME=D.PROGRAM_NAME AND A.AGENCY=D.AGENCY;
          

---VARIENCE POPULATION IN SQL QUERY

SELECT ST_ID,ST_NAME,MARKS,A.TOP,A.LEAST,A.TOP-MARKS VARIENCE_TOP,A.LEAST-MARKS VARIENCE_LEAST
FROM (SELECT MAX(MARKS)TOP,MIN(MARKS)LEAST FROM SOURCE_DATA)A,SOURCE_DATA;   